model:
  oarepo:marshmallow:
    generate: false
    "*generate": true   # generate only if this module is not imported as a library
    class: oarepo_vocabularies.basic.services.schema.OARepoVocabulariesBasicSchema
    base-classes: [ "invenio_vocabularies.services.schema.BaseVocabularySchema" ]

  properties:
    # invenio vocabulary
    uuid:
      type: keyword
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    indexed_at:
      type: date
      oarepo:marshmallow:
        generate: false

    created:
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    updated:
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    type:
      properties:
        pid_type:
          type: keyword
        id:
          type: keyword
      oarepo:marshmallow: # type is required but is not in invenio base schema, so add here
        field: ma_fields.Str(required=True, attribute="type.id")
        generate: false
        "*generate": true
    pid:
      properties:
        pk:
          type: integer
          oarepo:mapping:
            type: integer
        pid_type:
          type: keyword
        obj_type:
          type: keyword
        status:
          type: keyword
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    title_sort:
      type: keyword
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    title:
      type: object
      propertyNames:
        pattern: "^[a-z]{2}$"
      additionalProperties:
        type: keyword
      oarepo:mapping:
        dynamic: true
        type: object
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    description:
      type: object
      propertyNames:
        pattern: "^[a-z]{2}$"
      additionalProperties:
        type: keyword
      oarepo:mapping:
        dynamic: true
        type: object
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false

    icon:
      type: keyword
      oarepo:mapping:
        index: false
        type: keyword
      oarepo:marshmallow: # leave invenio-vocabularies default
        generate: false


    # hvocabulary
    hierarchy:
      type: object
      oarepo:marshmallow:
        generate: false        # just in elasticsearch, so no need to have it in marshmallow/API
      properties:
        level:
          type: integer
          oarepo:marshmallow:
            write: false
            read: false

        path:
          type: fulltext
          oarepo:mapping:
            type: text
            copy_to: hierarchy_reverse_path
            analyzer: oarepo_hvocabularies_analyzer
            search_analyzer: standard
          oarepo:marshmallow:
            write: false
            read: false

        reverse_path:
          type: fulltext
          oarepo:mapping:
            type: text
            analyzer: oarepo_hvocabularies_reverse_analyzer
            search_analyzer: standard
          oarepo:marshmallow:
            write: false
            read: false
